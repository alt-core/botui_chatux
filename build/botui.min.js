/*
 * botui 0.3.7
 * A JS library to build the UI for your bot
 * https://botui.org
 *
 * Copyright 2021, Moin Uddin
 * Released under the MIT license.
*/

!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],function(){return t.BotUI=e(t)}):t.BotUI=e(t)}("undefined"!=typeof window?window:this,function(g,t){"use strict";return function(t,e){if(e=e||{},!t)throw Error("BotUI: Container id is required as first argument.");if(!document.getElementById(t))throw Error("BotUI: Element with id #"+t+" does not exist.");if(!g.Vue&&!e.vue)throw Error("BotUI: Vue is required but not found.");var i,n,a={debug:!1,fontawesome:!0,searchselect:!0},s={},o=/!\(([^\)]+)\)/gim,c=/!\[(.*?)\]\((.*?)\)/gim,u=/\[([^\[]+)\]\(([^\)]+)\)(\^?)/gim;for(n in g.Vue=g.Vue||e.vue,a)e.hasOwnProperty(n)&&(a[n]=e[n]);function r(t,e,n,o){return"<a class='botui-message-content-link' target='"+(o?"blank":"")+"' href='"+n+"'>"+e+"</a>"}function l(t,e){var n=document.createElement("script");n.type="text/javascript",n.src=t,e&&(n.onload=e),document.body.appendChild(n)}function h(t){d.action.addMessage&&s.message.human({delay:100,content:t}),d.action.show=!d.action.autoHide}g.Promise||"undefined"!=typeof Promise||e.promise||l("https://cdn.jsdelivr.net/es6-promise/4.1.0/es6-promise.min.js");var f={template:"<div class=\"botui botui-container\" v-botui-container><div class=\"botui-messages-container\"><div v-for=\"msg in messages\" class=\"botui-message\" :class=\"msg.cssClass\" v-botui-scroll><div v-if=\"msg.visible\"><div v-if=\"!msg.human && msg.botPhoto\"><div v-if=\"!msg.loading\" :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :src=\"msg.botPhoto\"></div></div><div v-if=\"msg.human && msg.humanPhoto\"><div v-if=\"!msg.loading\" :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :src=\"msg.humanPhoto\"></div></div><div v-if=\"!msg.human && !msg.botPhoto\"><div v-if=\"msg.photo && !msg.loading\" :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :class=\"[{human: msg.human, \'agent\': !msg.human}]\"></div></div></div><transition :name=\"msg.human? \'slide-fade-l2r\':\'slide-fade-r2l\'\"><div v-if=\"msg.visible\"><div :class=\"[{human: msg.human, \'botui-message-content\': true}, msg.type]\"><span v-if=\"msg.type == \'text\'\" v-text=\"msg.content\" v-botui-markdown></span><span v-if=\"msg.type == \'html\'\" v-html=\"msg.content\"></span> <iframe v-if=\"msg.type == \'embed\'\" :src=\"msg.content\" frameborder=\"0\" allowfullscreen></iframe><dynamic v-if=\"msg.type == \'dynamic\'\" :content=\"msg.content\"></dynamic></div></div></transition><div v-if=\"msg.loading\"><div v-if=\"!msg.human && msg.botPhoto\"><div :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :src=\"msg.botPhoto\"></div></div><div v-if=\"msg.human && msg.humanPhoto\"><div :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :src=\"msg.humanPhoto\"></div></div><div v-if=\"!msg.human && !msg.botPhoto\"><div v-if=\"msg.photo\" :class=\"[\'profil\', {human: msg.human, \'agent\': !msg.human}]\"> <img :class=\"[{human: msg.human, \'agent\': !msg.human}]\"></div></div></div><div v-if=\"msg.loading\" class=\"botui-message-content loading\"><i class=\"dot\"></i><i class=\"dot\"></i><i class=\"dot\"></i></div></div></div><div class=\"botui-actions-container\"><transition name=\"slide-fade\"><div v-if=\"action.show\" v-botui-scroll><form v-if=\"action.type == \'text\'\" class=\"botui-actions-text\" @submit.prevent=\"handle_action_text()\" :class=\"action.cssClass\"><i v-if=\"action.text.icon\" class=\"botui-icon botui-action-text-icon fa\" :class=\"\'fa-\' + action.text.icon\"></i> <input type=\"text\" ref=\"input\" :type=\"action.text.sub_type\" v-model=\"action.text.value\" class=\"botui-actions-text-input\" :placeholder=\"action.text.placeholder\" :size=\"action.text.size\" :value=\" action.text.value\" :class=\"action.text.cssClass\" required v-focus/> <button type=\"submit\" :class=\"{\'botui-actions-buttons-button\': !!action.text.button, \'botui-actions-text-submit\': !action.text.button}\"><i v-if=\"action.text.button && action.text.button.icon\" class=\"botui-icon botui-action-button-icon fa\" :class=\"\'fa-\' + action.text.button.icon\"></i> <span>{{(action.text.button && action.text.button.label) || \'Go\'}}</span></button></form><form v-if=\"action.type == \'select\'\" class=\"botui-actions-select\" @submit.prevent=\"handle_action_select()\" :class=\"action.cssClass\"><i v-if=\"action.select.icon\" class=\"botui-icon botui-action-select-icon fa\" :class=\"\'fa-\' + action.select.icon\"></i><v-select v-if=\"action.select.searchselect && !action.select.multipleselect\" v-model=\"action.select.value\" :value=\"action.select.value\" :placeholder=\"action.select.placeholder\" class=\"botui-actions-text-searchselect\" :label=\"action.select.label\" :options=\"action.select.options\"></v-select><v-select v-else-if=\"action.select.searchselect && action.select.multipleselect\" multiple v-model=\"action.select.value\" :value=\"action.select.value\" :placeholder=\"action.select.placeholder\" class=\"botui-actions-text-searchselect\" :label=\"action.select.label\" :options=\"action.select.options\"></v-select> <select v-else v-model=\"action.select.value\" class=\"botui-actions-text-select\" :placeholder=\"action.select.placeholder\" :size=\"action.select.size\" :class=\"action.select.cssClass\" required v-focus><option v-for=\"option in action.select.options\" :class=\"action.select.optionClass\" v-bind:value=\"option.value\" :disabled=\"(option.value == \'\')?true:false\" :selected=\"(action.select.value == option.value)?\'selected\':\'\'\"> {{ option.text }}</option></select> <button type=\"submit\" :class=\"{\'botui-actions-buttons-button\': !!action.select.button, \'botui-actions-select-submit\': !action.select.button}\"><i v-if=\"action.select.button && action.select.button.icon\" class=\"botui-icon botui-action-button-icon fa\" :class=\"\'fa-\' + action.select.button.icon\"></i> <span>{{(action.select.button && action.select.button.label) || \'Ok\'}}</span></button></form><div v-if=\"action.type == \'button\'\" class=\"botui-actions-buttons\" :class=\"action.cssClass\"> <button type=\"button\" :class=\"button.cssClass\" class=\"botui-actions-buttons-button\" v-for=\"button in action.button.buttons\" @click=\"handle_action_button(button)\"><i v-if=\"button.icon\" class=\"botui-icon botui-action-button-icon fa\" :class=\"\'fa-\' + button.icon\"></i> {{button.text}}</button></div><form v-if=\"action.type == \'buttontext\'\" class=\"botui-actions-text\" @submit.prevent=\"handle_action_text()\" :class=\"action.cssClass\"><i v-if=\"action.text.icon\" class=\"botui-icon botui-action-text-icon fa\" :class=\"\'fa-\' + action.text.icon\"></i> <input type=\"text\" ref=\"input\" :type=\"action.text.sub_type\" v-model=\"action.text.value\" class=\"botui-actions-text-input\" :placeholder=\"action.text.placeholder\" :size=\"action.text.size\" :value=\"action.text.value\" :class=\"action.text.cssClass\" required v-focus/> <button type=\"submit\" :class=\"{\'botui-actions-buttons-button\': !!action.text.button, \'botui-actions-text-submit\': !action.text.button}\"><i v-if=\"action.text.button && action.text.button.icon\" class=\"botui-icon botui-action-button-icon fa\" :class=\"\'fa-paper-plane\' +  action.text.button.icon\"></i> <span>{{(action.text.button && action.text.button.label) || \'Go\'}}</span></button><div class=\"botui-actions-buttons\" :class=\"action.cssClass\"> <button type=\"button\" :class=\"button.cssClass\" class=\"botui-actions-buttons-button\" v-for=\"button in action.button.buttons\" @click=\"handle_action_button(button)\" autofocus><i v-if=\"button.icon\" class=\"botui-icon botui-action-button-icon fa\" :class=\"\'fa-\' + button.icon\"></i> {{button.text}}</button></div></form></div></transition></div></div>",components:{dynamic:{props:{content:String},render:function(t){return t("div",[t(g.Vue.compile(this.content))])}}},data:function(){return{action:{text:{size:30,placeholder:"Write here .."},button:{},show:!1,type:"text",autoHide:!0,addMessage:!0},messages:[]}},computed:{isMobile:function(){return g.innerWidth&&g.innerWidth<=768}},methods:{handle_action_button:function(t){for(var e=0;e<this.action.button.buttons.length;e++)if(this.action.button.buttons[e].value==t.value&&"function"==typeof this.action.button.buttons[e].event){if(this.action.button.buttons[e].event(t),this.action.button.buttons[e].actionStop)return!1;break}h(t.text);var n,o={type:"button",text:t.text,value:t.value};for(n in t)t.hasOwnProperty(n)&&"type"!==n&&"text"!==n&&"value"!==n&&(o[n]=t[n]);i(o)},handle_action_text:function(){this.action.text.value&&(h(this.action.text.value),i({type:"text",value:this.action.text.value}),this.action.text.value="")},handle_action_select:function(){if(this.action.select.searchselect&&!this.action.select.multipleselect){if(!this.action.select.value.value)return;h(this.action.select.value[this.action.select.label]),i({type:"text",value:this.action.select.value.value,text:this.action.select.value.text,obj:this.action.select.value})}if(this.action.select.searchselect&&this.action.select.multipleselect){if(this.action.select.value){for(var t=new Array,e=new Array,n=0;n<this.action.select.value.length;n++)t.push(this.action.select.value[n].value),e.push(this.action.select.value[n][this.action.select.label]);h(e.join(", ")),i({type:"text",value:t.join(", "),text:e.join(", "),obj:this.action.select.value})}}else if(this.action.select.value)for(n=0;n<this.action.select.options.length;n++)this.action.select.options[n].value==this.action.select.value&&(h(this.action.select.options[n].text),i({type:"text",value:this.action.select.value,text:this.action.select.options[n].text}))}}};g.Vue.directive("botui-markdown",function(t,e){"false"!=e.value&&(t.innerHTML=t.textContent.replace(c,"<img class='botui-message-content-image' src='$2' alt='$1' />").replace(o,"<i class='botui-icon botui-message-content-icon fa fa-$1'></i>").replace(u,r))}),g.Vue.directive("botui-scroll",{inserted:function(t){var e=document.querySelector(".botui-container");e.scrollTop=e.scrollHeight}}),g.Vue.directive("focus",{inserted:function(t){t.focus()}}),g.Vue.directive("botui-container",{inserted:function(t){0}});var d=(t=new g.Vue({components:{"bot-ui":f}}).$mount("#"+t)).$children[0];function p(n){if(!n.loading&&!n.content)throw Error('BotUI: "content" is required in a non-loading message object.');n.type=n.type||"text",n.visible=!n.delay&&!n.loading,n.human&&s.opt.humanPhoto&&(n.humanPhoto=s.opt.humanPhoto),!n.human&&s.opt.botPhoto&&(n.botPhoto=s.opt.botPhoto),n.afterUpdate=!1;var o=d.messages.push(n)-1;return new Promise(function(t,e){setTimeout(function(){n.delay&&(n.visible=!0,n.loading&&(n.loading=!1)),t(o)},n.delay||0)})}function v(t){return(t="string"==typeof t?{content:t}:t)||{}}function m(t){if(!t.action&&!t.actionButton&&!t.actionText)throw Error('BotUI: "action" property is required.')}function b(n){return m(n),function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}({type:"text",cssClass:"",autoHide:!0,addMessage:!0},n),d.action.type=n.type,d.action.cssClass=n.cssClass,d.action.autoHide=n.autoHide,d.action.addMessage=n.addMessage,new Promise(function(t,e){i=t,setTimeout(function(){d.action.show=!0},n.delay||0)})}return s.message={add:function(t){return p(v(t))},bot:function(t){return p(t=v(t))},human:function(t){return(t=v(t)).human=!0,p(t)},get:function(t){return Promise.resolve(d.messages[t])},remove:function(t){return d.messages.splice(t,1),Promise.resolve()},update:function(t,e){t=d.messages[t];return t.content=e.content,t.visible=!e.loading,t.loading=!!e.loading,t.afterUpdate=!0,Promise.resolve(e.content)},removeAll:function(){return d.messages.splice(0,d.messages.length),Promise.resolve()}},s.opt={humanPhoto:null,botPhoto:null,setHumanPhoto:function(t){this.humanPhoto=t},setBotPhoto:function(t){this.botPhoto=t}},s.action={show:b,hide:function(){return d.action.show=!1,Promise.resolve()},text:function(t){return m(t),d.action.text=t.action,b(t)},button:function(t){return m(t),t.type="button",d.action.button.buttons=t.action,b(t)},select:function(t){if(m(t),t.type="select",t.action.label=t.action.label||"text",t.action.value=t.action.value||"",t.action.searchselect=(void 0!==t.action.searchselect?t.action:a).searchselect,t.action.multipleselect=t.action.multipleselect||!1,t.action.searchselect&&"string"==typeof t.action.value)if(t.action.multipleselect){var e=t.action.value.split(",");t.action.value=new Array;for(o=0;o<t.action.options.length;o++)for(var n=0;n<e.length;n++)t.action.options[o].value==e[n]&&t.action.value.push(t.action.options[o])}else for(var o=0;o<t.action.options.length;o++)t.action.options[o].value==t.action.value&&(t.action.value=t.action.options[o]);return t.action.searchselect||t.action.options.unshift({value:"",text:t.action.placeholder}),d.action.button=t.action.button,d.action.select=t.action,b(t)},buttontext:function(t){return m(t),t.type="buttontext",d.action.button.buttons=t.actionButton,d.action.text=t.actionText,b(t)}},a.fontawesome&&l("https://use.fontawesome.com/ea731dcb6f.js"),a.searchselect&&l("https://unpkg.com/vue-select@2.4.0/dist/vue-select.js",function(){Vue.component("v-select",VueSelect.VueSelect)}),a.debug&&(s._botApp=t),s}});